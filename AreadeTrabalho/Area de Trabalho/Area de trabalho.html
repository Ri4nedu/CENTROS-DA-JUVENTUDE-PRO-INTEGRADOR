
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årea Principal</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="area_de_trabalho.js" defer></script>
</head>
<body>
   
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="gov-info">
                    <span>IF</span>
                    <span>INSTITUTO FEDERAL CR/BIOPARK</span>
                </div>
                <div class="accessibility-links">
                    <a href="#">Sobre</a>
                    <a href="#">Produ√ß√£o</a>
                </div>
            </div>
        </div>
        <main class="header-main">
            <div class="container">
                <div class="logo-section">
                    <img src="../../imagens-homepage/logo_synflow-removebg-preview.png" alt="Imagem logo" style="width: 85px; height: 85px;  border-radius: 4px; display: flex; align-items: center; justify-content: center;margin: 1%;;"></img>
                    <div class="system-title">
                        <h1>Synflow</h1>
                    </div>
                </div>

                
                    <div class="user-avatar" >JS</div>
                </div>
            </div>
        </div>
        <nav class="navigation">
            <div class="nav-container">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="/AreadeTrabalho/Servi√ßos/Area de trabalho.html" class="nav-link active" onclick="showSection('home')">Principal</a>
                    </li>
                    <li class="nav-item">
                        <a href="/AreadeTrabalho/Servi√ßos/comp.html" class="nav-link">Servi√ßos</a>
                    </li>
                    <li class="nav-item">
                        <a href="/AreadeTrabalho/Quadro de Funcionarios/quadro.html" class="nav-link" onclick="showSection('financial')">Funcionarios</a>
                    </li>
                    <li class="nav-item">
                        <a href="/AreadeTrabalho/Calendario/cal.html" class="nav-link" onclick="showSection('documents')">Calend√°rio</a>
                    </li>
                </ul>
                <div class="nav-search">
                    <input type="text" class="search-input" placeholder="Buscar no sistema...">
                    <button class="search-btn">üîç</button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Container -->

        <!-- Main Content -->
        <main class="main-content">
            <div class="content-header">
                <div>
                    <h2 class="content-title" id="contentTitle">Dashboard Principal</h2>
                    <div class="breadcrumb">
                        <a href="#">In√≠cio</a> > <span id="breadcrumbCurrent">Dashboard</span>
                    </div>
                </div>
            </div>
            
            


<div class="content-body" id="contentBody">
    <div id="dashboard-content">
        <div class="dashboard-grid">

            <!-- Frequ√™ncia -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon academic">üéì</div>
                    <h3 class="card-title">Frequ√™ncia</h3>
                </div>
                <div class="card-charts" style="max-width: 150px; margin: auto;">
                    <canvas id="frequenciaChart" width="150" height="150"></canvas>
                </div>
                <div class="card-stats">
                    <div class="stat-item">
                        <div class="stat-number">8.7</div>
                        <div class="stat-label">M√©dia Geral</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">15</div>
                        <div class="stat-label">Faltas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">85%</div>
                        <div class="stat-label">Frequ√™ncia</div>
                    </div>
                </div>
            </div>

            <!-- Situa√ß√£o Financeira -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon financial">üí∞</div>
                    <h3 class="card-title">Situa√ß√£o Financeira</h3>
                </div>
                <p class="card-description">Consulte aux√≠lios, bolsas, pagamentos e d√©bitos pendentes.</p>
                <div class="card-stats">
                    <div class="stat-item">
                        <div class="stat-number">R$ 400</div>
                        <div class="stat-label">Aux√≠lio Estudantil</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">0</div>
                        <div class="stat-label">D√©bitos</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">Em dia</div>
                        <div class="stat-label">Situa√ß√£o</div>
                    </div>
                </div>
            </div>

           
             <!-- Meu Perfil -->
             <div class="dashboard-card" onclick="window.location.href='usuario.html'" style="cursor: pointer;">
                <!-- conte√∫do igual ao anterior -->
             
              
              
                  <div class="card-header">
                    <div class="card-icon profile">üë§</div>
                    <h3 class="card-title">Meu Perfil</h3>
                  </div>
                  <p class="card-description">Gerencie seus dados pessoais, contatos e configura√ß√µes.</p>
                  <div class="card-stats">
                    <div class="stat-item">
                      <div class="stat-number">95%</div>
                      <div class="stat-label">Completo</div>
                    </div>
                    <div class="stat-item">
                      <div class="stat-number">‚úì</div>
                      <div class="stat-label">Verificado</div>
                    </div>
                    <div class="stat-item">
                      <div class="stat-number">Ativo</div>
                      <div class="stat-label">Status</div>
                    </div>
                  </div>
                </div>
              </a>
              

            <!-- Entrega de Relat√≥rio -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon report">üìù</div>
                    <h3 class="card-title">Entrega de Relat√≥rios</h3>
                </div>
                <p class="card-description">Insira seu relat√≥rio abaixo e clique em "Enviar".</p>
                <div class="report-upload">
                    <textarea placeholder="Digite ou cole seu relat√≥rio aqui..."></textarea>
                    <button>Enviar Relat√≥rio</button>
                </div>
            </div>
        </main>
        </div>
    </div>
</div>
        
        
</body>
 <script type="module">
  import { supabase } from '/js/supabaseClient.js'

  async function checkAuth() {
    const { data } = await supabase.auth.getUser()
    const user = data.user
    if (!user) {
      window.location.href = '/area de login/login.html'
      return
    }

    // Exibir nome no header (busca na tabela users)
    const { data: u } = await supabase
      .from('users')
      .select('nome, email, papel_global')
      .eq('id', user.id)
      .single()

    if (u) {
      // exemplo: colocar no elemento .user-details
      const el = document.querySelector('.user-details h3')
      if (el) el.textContent = `Nome: ${u.nome}`
      const p = document.querySelector('.user-details p')
      if (p) p.textContent = `${u.papel_global} - ${user.email}`
    }

    // Buscar company_id(s) do usu√°rio
    const { data: links } = await supabase
      .from('company_users')
      .select('company_id, role')
      .eq('user_id', user.id)

    // Se for admin ou employee, pegar primeira company e mostrar funcion√°rios
    if (links && links.length > 0) {
      const companyId = links[0].company_id

      // buscar funcion√°rios (join com users)
      const { data: membros } = await supabase
        .from('company_users')
        .select('role, users(id, nome, email)')
        .eq('company_id', companyId)

      // renderizar lista em um elemento (ex: div#teamList)
      const team = document.getElementById('teamList')
      if (team && membros) {
        team.innerHTML = membros.map(m => `
          <div class="member">
            <strong>${m.users.nome}</strong> (${m.role}) - ${m.users.email}
          </div>
        `).join('')
      }
    }
  }

  checkAuth()
</script>
<script type="module">
  import { supabase } from "../login/js/supabaseClient.js";

  async function verificarSessao() {
    const {
      data: { session },
    } = await supabase.auth.getSession();

    // Se n√£o estiver logado ‚Üí redireciona para o login
    if (!session) {
      window.location.href = "../../login/area de login/login.html";
    }
  }

  verificarSessao();
</script>

</html>

